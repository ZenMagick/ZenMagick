<?xml version="1.0" encoding="UTF-8" ?>

<routes xmlns="http://symfony.com/schema/routing"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://symfony.com/schema/routing http://symfony.com/schema/routing/routing-1.0.xsd">

    <!-- global routes -->
    <route id="zenmagick_global_routing" pattern="^^">
      <option key="view:login">redirect://login</option>
      <option key="view:empty_cart">redirect://shopping_cart</option>
    </route>

    <route id="rss" pattern="/rss/{channel}/{key}">
        <default key="_controller">zenmagick\http\controller\RssController:generate</default>
        <default key="key"></default>
    </route>

    <route id="cart.add" pattern="/cart/add">
        <default key="_controller">zenmagick\apps\store\storefront\controller\ShoppingCartController:addProduct</default>
        <option key="view:success">redirect://shopping_cart</option>
    </route>

    <!-- TODO: this should be POST -->
    <route id="cart.remove" pattern="/cart/remove/{product_id}">
        <default key="_controller">zenmagick\apps\store\storefront\controller\ShoppingCartController:removeProduct</default>
        <option key="view:success">redirect://shopping_cart</option>
    </route>

    <route id="cart.update" pattern="/cart/update">
        <default key="_controller">zenmagick\apps\store\storefront\controller\ShoppingCartController:update</default>
        <option key="view:success">redirect://shopping_cart</option>
    </route>

    <route id="cart" pattern="/cart">
        <default key="_controller">zenmagick\apps\store\storefront\controller\ShoppingCartController:show</default>
        <requirement key="_method">GET</requirement>
        <option key="view">views/shopping_cart.php</option>
    </route>

    <route id="shopping_cart" pattern="/cart">
        <default key="_controller">zenmagick\apps\store\storefront\controller\ShoppingCartController:show</default>
        <requirement key="_method">GET</requirement>
    </route>

    <route id="login" pattern="/login">
        <default key="_controller">zenmagick\apps\store\storefront\controller\LoginController</default>
        <option key="view:account">redirect://account</option>
        <option key="view:success">redirect://account</option>
    </route>

    <route id="account_edit" pattern="/account/edit">
        <default key="_controller">zenmagick\apps\store\storefront\controller\AccountEditController</default>
        <option key="view:success">redirect://account</option>
        <option key="form">ZMAccountForm#formId=account</option>
    </route>

</routes>
