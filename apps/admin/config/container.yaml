parameters:
  # default session timeout
  admin.session_timeout: 1440

services:
  ZMRequest:
    class: Request
    scope: container
    calls:
      - [setSession, [@ZMSession]]

  ZMPlugins:
    class: Plugins
    scope: container
  pluginService: @ZMPlugins

  sessionHandler:
    class: ZMZenCartSessionHandler
    scope: container
    calls:
      - [setExpiryTime, [%admin.session_timeout%]]

  storeViewUtils:
    class: ZMViewUtils
    scope: prototype
    calls:
      - [setResourcesAsTemplates, [true]]

  storeEmailView:
    class: SavantView
    scope: prototype
    calls:
      - [setConfig, [{ 'cache' => 'ZMSimpleSavantCache' }]]
      - [setFilters, ['ZMShortTagFilter']]
      - [setViewUtils, [@storeViewUtils]]

  ZMSavantView:
    class: ZMSavantView
    scope: prototype
    calls:
      - [setConfig, [{ 'cache' => 'ZMSimpleSavantCache' }]]
      - [setFilters, ['ZMShortTagFilter']]
  defaultView: @ZMSavantView

  messageService:
    class: ZMMessages
    scope: container

  adminUserPrefService:
    class: ZMAdminUserPrefs
    scope: container

  adminUserRoleService:
    class: ZMAdminUserRoles
    scope: container

  adminUserService:
    class: ZMAdminUsers
    scope: container

  sacsPermissionService:
    class: ZMSacsPermissions
    scope: container

  ZMInstallationPatcher:
    class: ZMInstallationPatcher
    scope: container

  ZMSession:
    class: zenmagick\http\session\Session
    scope: container
    calls:
      - [setName, ['zmAdmin']]
      - [registerSessionHandler, [@sessionHandler]]
      # XXX: TODO: remove; for zc admin compatibility
      - [setSyncSessionData, [false]]
