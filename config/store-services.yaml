##
## Shared ZenMagick services
##

parameters:
  kernel.root_dir: %zenmagick.cacheBaseDir%/kernel
  kernel.cache_dir: %zenmagick.cacheBaseDir%
  kernel.debug: false
  kernel.bundles: %zenmagick.bundles%
  zenmagick.installationPath: '<?php echo dirname(zenmagick\base\Runtime::getInstallationPath()) ?>'
  zenmagick.cacheIds: ['transientCache', 'persistentCache', 'servicesCache', 'templateCache']
  zenmagick.cacheBaseDir: '<?php echo dirname(zenmagick\base\Runtime::getInstallationPath())."/cache/zenmagick" ?>'

services:
  ## generic caches
  transientCache:
    class: zenmagick\base\cache\MemoryCache
    scope: prototype
    calls:
      - [init, ['global', {}]]
  persistentCache:
    class: zenmagick\base\cache\FileCache
    scope: prototype
    calls:
      - [init, ['global', {cacheTTL: 300, cacheDir: '%zenmagick.cacheBaseDir%/files/'}]]

  ## explicit caches
  servicesCache:
    class: zenmagick\base\cache\MemoryCache
    scope: container
    calls:
      - [init, ['services', {}]]
  templateCache:
    class: zenmagick\base\cache\FileCache
    scope: container
    calls:
      - [init, ['services', {cacheTTL: 300, cacheDir: '%zenmagick.cacheBaseDir%/templates/'}]]

  accountService:
    class: ZMAccounts
    scope: container

  addressService:
    class: ZMAddresses
    scope: container

  countryService:
    class: ZMCountries
    scope: container

  orderService:
    class: ZMOrders
    scope: container

  ZMThemes:
    class: ZMThemes
    scope: container
    calls:
      - [setCache, [@servicesCache]]
  themeService: @ZMThemes

  ZMManufacturers:
    class: ZMManufacturers
    scope: container
    calls:
      - [setCache, [@servicesCache]]
  manufacturerService: @ZMManufacturers

  ZMProducts:
    class: ZMProducts
    scope: container
    calls:
      - [setCache, [@servicesCache]]
  productService: @ZMProducts

  ZMCategories:
    class: ZMCategories
    scope: container
    calls:
      - [setCache, [@servicesCache]]
  categoryService: @ZMCategories

  ZMSimpleSavantCache:
    class: ZMSimpleSavantCache
    scope: container
    calls:
      - [setCache, [@templateCache]]

  rssLoader:
    class: zenmagick\http\rss\RssFeedLoader
    scope: container
    calls:
      - [init, [{cacheTTL: 300, cacheDir: '%zenmagick.cacheBaseDir%/rss/'}]]

  loggingService:
    class: zenmagick\base\logging\Logging
    scope: container

  eventDispatcher:
    class: zenmagick\base\events\EventDispatcher
    scope: container

  settingsService:
    class: zenmagick\base\settings\Settings
    scope: container

  authenticationManager:
    class: ZMAuthenticationManager
    scope: container

  sacsManager:
    class: zenmagick\http\sacs\SacsManager
    scope: container
   
  blockManager:
    class: ZMBlockManager
    scope: container
